<!DOCTYPE html>
<html>
<head>
  <meta charset="UTF-8">
  <title>FNF - Digital Error (By GreenPawz)</title>
  <style>
    body {
      margin: 0;
      background: black;
      color: white;
      font-family: sans-serif;
      text-align: center;
      user-select: none;
    }
    canvas {
      display: block;
      margin: auto;
      background: #111;
      border: 4px solid lime;
    }
    button {
      font-size: 20px;
      margin: 10px;
      padding: 10px 20px;
      background: lime;
      border: none;
      cursor: pointer;
    }
  </style>
</head>
<body>
  <canvas id="game" width="800" height="600"></canvas>

  <audio id="song" loop>
    <source src="https://upload.wikimedia.org/wikipedia/commons/4/4e/Bach_-_Prelude_in_C_major_-_BWV_846.ogg" type="audio/ogg">
  </audio>

  <script>
    const canvas = document.getElementById("game");
    const ctx = canvas.getContext("2d");
    const song = document.getElementById("song");

    const arrows = ["←", "↑", "↓", "→"];
    const arrowKeys = ["ArrowLeft", "ArrowUp", "ArrowDown", "ArrowRight", "a", "w", "s", "d"];
    let pressed = {};
    let botMode = false;

    let gameState = "menu"; // menu, playing, paused

    function drawMenu() {
      ctx.clearRect(0, 0, canvas.width, canvas.height);
      ctx.fillStyle = "lime";
      ctx.font = "50px Arial";
      ctx.fillText("Friday Night Funkin'", 150, 200);
      ctx.fillText("Digital Error", 250, 260);
      ctx.font = "24px Arial";
      ctx.fillText("Press ENTER or SPACE to Start", 220, 350);
      ctx.fillText("Press B to Toggle Bot Mode", 260, 400);
    }

    function drawPauseMenu() {
      ctx.fillStyle = "rgba(0,0,0,0.7)";
      ctx.fillRect(0, 0, canvas.width, canvas.height);
      ctx.fillStyle = "white";
      ctx.font = "40px Arial";
      ctx.fillText("Paused", 340, 200);
      ctx.font = "24px Arial";
      ctx.fillText("Press R to Restart", 300, 300);
      ctx.fillText("Press M to Quit to Menu", 280, 340);
      ctx.fillText("Press ESC or P to Resume", 250, 380);
    }

    let fallingArrows = [];

    function spawnArrow() {
      let idx = Math.floor(Math.random() * arrows.length);
      fallingArrows.push({symbol: arrows[idx], x: 200 + idx*120, y: -50});
    }

    function updateGame() {
      for (let arrow of fallingArrows) {
        arrow.y += 4;
      }
      fallingArrows = fallingArrows.filter(a => a.y < 600);
    }

    function drawGame() {
      ctx.clearRect(0, 0, canvas.width, canvas.height);
      ctx.fillStyle = "lime";
      ctx.font = "48px Arial";
      ctx.fillText("Digital Error", 280, 100);
      ctx.font = "60px Arial";
      arrows.forEach((arrow, i) => {
        ctx.fillStyle = pressed[arrow] ? "red" : "white";
        ctx.fillText(arrow, 200 + i * 120, 500);
      });
      ctx.font = "50px Arial";
      for (let arrow of fallingArrows) {
        ctx.fillStyle = "cyan";
        ctx.fillText(arrow.symbol, arrow.x, arrow.y);
      }
    }

    function gameLoop() {
      if (gameState === "menu") {
        drawMenu();
      } else if (gameState === "playing") {
        updateGame();
        drawGame();
      } else if (gameState === "paused") {
        drawGame();
        drawPauseMenu();
      }
      requestAnimationFrame(gameLoop);
    }

    window.addEventListener("keydown", e => {
      if (gameState === "menu") {
        if (e.key === "Enter" || e.key === " ") {
          gameState = "playing";
          song.play();
          setInterval(spawnArrow, 800);
        }
        if (e.key.toLowerCase() === "b") {
          botMode = !botMode;
        }
      } else if (gameState === "playing") {
        if (e.key === "Escape" || e.key.toLowerCase() === "p") {
          gameState = "paused";
          song.pause();
        }
        if (arrowKeys.includes(e.key)) {
          let arrowSymbol = keyToSymbol(e.key);
          if (arrowSymbol) pressed[arrowSymbol] = true;
        }
      } else if (gameState === "paused") {
        if (e.key === "Escape" || e.key.toLowerCase() === "p") {
          gameState = "playing";
          song.play();
        }
        if (e.key.toLowerCase() === "r") {
          restartGame();
        }
        if (e.key.toLowerCase() === "m") {
          quitToMenu();
        }
      }
    });

    window.addEventListener("keyup", e => {
      if (arrowKeys.includes(e.key)) {
        let arrowSymbol = keyToSymbol(e.key);
        if (arrowSymbol) pressed[arrowSymbol] = false;
      }
    });

    function keyToSymbol(key) {
      switch (key) {
        case "ArrowLeft": case "a": return "←";
        case "ArrowUp": case "w": return "↑";
        case "ArrowDown": case "s": return "↓";
        case "ArrowRight": case "d": return "→";
        default: return null;
      }
    }

    function restartGame() {
      fallingArrows = [];
      pressed = {};
      gameState = "playing";
      song.currentTime = 0;
      song.play();
    }

    function quitToMenu() {
      fallingArrows = [];
      pressed = {};
      gameState = "menu";
      song.pause();
      song.currentTime = 0;
    }

    gameLoop();
  </script>
</body>
</html>
